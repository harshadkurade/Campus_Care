// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id                 Int              @id @default(autoincrement())
  name               String
  email              String           @unique
  password           String
  isAdmin            Boolean          @default(false)
  isDoctor           Boolean          @default(false)
  notification       Json             @default("[]") // Changed from Json[] to Json
  seenNotification   Json             @default("[]") // Changed from Json[] to Json
  doctor             Doctor?          // Removed relation attributes
  doctorId           Int?
  appointments       Appointment[]
  createdAt          DateTime         @default(now())
  updatedAt          DateTime         @updatedAt

  @@map("users")
}

model Doctor {
  id                   Int              @id @default(autoincrement())
  userId               Int              @unique
  user                 User             @relation(fields: [userId], references: [id], onDelete: Cascade)
  firstName            String
  lastName             String
  phone                String
  email                String           @unique
  website              String?
  address              String
  specialization       String
  experience           String
  feesPerCunsaltation  Int
  status               String           @default("pending")
  timings              Json             // Using JSON for object
  appointments         Appointment[]
  createdAt            DateTime         @default(now())
  updatedAt            DateTime         @updatedAt

  @@map("doctors")
}

model Appointment {
  id          Int      @id @default(autoincrement())
  userId      Int
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  doctorId    Int
  doctor      Doctor   @relation(fields: [doctorId], references: [id], onDelete: Cascade)
  doctorInfo  Json
  userInfo    Json
  date        String
  time        String
  status      String   @default("pending")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("appointments")
}